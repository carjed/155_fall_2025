<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>l13-mlr-model-building-1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="_L13-mlr-model-building-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="_L13-mlr-model-building-1_files/libs/quarto-html/quarto.js"></script>
<script src="_L13-mlr-model-building-1_files/libs/quarto-html/popper.min.js"></script>
<script src="_L13-mlr-model-building-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="_L13-mlr-model-building-1_files/libs/quarto-html/anchor.min.js"></script>
<link href="_L13-mlr-model-building-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="_L13-mlr-model-building-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="_L13-mlr-model-building-1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="_L13-mlr-model-building-1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="_L13-mlr-model-building-1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="notes" class="level1">
<h1>Notes</h1>
<section id="learning-goals" class="level2">
<h2 class="anchored" data-anchor-id="learning-goals">Learning goals</h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li><p>Distinguish between descriptive, predictive, and causal research questions</p></li>
<li><p>Identify confounders, colliders, precision variables, mediators, and effect modifiers in a causal diagram</p></li>
<li><p>Explain when variables are redundant or multicollinear</p></li>
<li><p>Relate redundancy and multicollinearity to coefficient estimates and <span class="math inline">\(R^2\)</span></p></li>
<li><p>Explain why adjusted <span class="math inline">\(R^2\)</span> is preferable to multiple <span class="math inline">\(R^2\)</span> when comparing models with different numbers of predictors</p></li>
</ul>
</section>
<section id="readings-and-videos" class="level2">
<h2 class="anchored" data-anchor-id="readings-and-videos">Readings and videos</h2>
<p>Please watch the following video <strong>before</strong> class.</p>
<ul>
<li>Video: <a href="https://voicethread.com/share/15362352/">Causal Diagrams and Confounding Variables</a></li>
</ul>
<p>Optional:</p>
<ul>
<li>Reading: Section 3.9.5 in the <a href="https://mac-stat.github.io/Stat155Notes/">STAT 155 Notes</a></li>
<li>Video: <a href="https://voicethread.com/share/15177737/">Redundancy and Multicollinearity</a></li>
</ul>
</section>
</section>
<section id="part-1-the-3-types-of-research-questions-we-can-investigate-using-statistical-models" class="level1">
<h1>Part 1: The 3 types of research questions we can investigate using statistical models</h1>
<section id="descriptive-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-research-questions">1: Descriptive Research Questions</h2>
<p>Descriptive research questions are questions that seek to better understand the characteristics of individual variables and/or relationships between them.</p>
<ul>
<li><p>univariate numerical summaries</p></li>
<li><p>univariate/bivariate visualizations</p></li>
<li><p>(simple, i.e., single-predictor) models to:</p>
<ul>
<li><p>formalize how we conceptualize/estimate the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (e.g., write a model statement)</p></li>
<li><p>more precisely quantify the estimated effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> (e.g., what does <span class="math inline">\(\hat\beta_{1}\)</span> tell us?)</p>
<ul>
<li>also assess our uncertainty in that estimate (more on this later in the semester!)</li>
</ul></li>
<li><p>measure the strength of the estimated relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (e.g., <span class="math inline">\(R^2\)</span>)</p></li>
</ul></li>
</ul>
<p>If we’re only interested in <em>associations</em> (not causal relationships), we don’t need to adjust for potential confounding variables–usually descriptive questions are dealing with simple/bivariate analyses.</p>
<p><strong>Statistical analyses almost always start with descriptive research questions, and we iterate on these descriptive questions throughout the process!</strong></p>
<p><strong>Let’s brainstorm some descriptive research questions!</strong></p>
<p>Check out the codebook for a dataset of giant pumpkins:</p>
<p><a href="https://github.com/rfordatascience/tidytuesday/blob/main/data/2021/2021-10-19/readme.md#giant-pumpkins" class="uri">https://github.com/rfordatascience/tidytuesday/blob/main/data/2021/2021-10-19/readme.md#giant-pumpkins</a></p>
<p>Run the following code to load the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pumpkins <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2021/2021-10-19/pumpkins.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>With your groups:</strong> brainstorm 4-5 <strong>descriptive</strong> research questions you could ask about this dataset. Think about the following:</p>
<ul>
<li><p>what relationships between variables might be interesting to look at</p></li>
<li><p>what univariate numerical summaries you would calculate</p></li>
<li><p>what univariate/bivariate visualizations you would use to explore these relationships</p></li>
</ul>
<p>(…and if you’re feeling ambitious, try to code up answers to these as a group!)</p>
</section>
<section id="predictive-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="predictive-research-questions">2: Predictive Research Questions</h2>
<p>Predictive research questions seek to determine if (and how well) we can predict outcomes for new / future events, using the information we already have. We’ve seen a bit of prediction in this course when we talked about fitted values!</p>
<p>Suppose we are a tech startup looking to <del>financially exploit</del> revolutionize the pumpkin-growing community by selling a model that can accurately predict a pumpkin’s eventual weight (<code>weight_lbs</code>) based on a constellation of other variables (location, genetics, variety, etc.). We have a meeting with potential investors in two weeks and want to prove to them that our <del>linear regression</del> “artificial intelligence” model, which we trained on the <code>pumpkins</code> dataset.</p>
<p>With your groups, discuss the following questions:</p>
<ul>
<li>First, discuss which of the available predictor(s) you would you include in the model. Why these variables? If you excluded any variables, why not those?</li>
<li>How do you think you would go about proving that your model’s predictions are “good”?</li>
<li>Are there any variables that are <em>not</em> available to you in the <code>pumpkins</code> dataset that you would include in your predictive model if you could? Why or why not?</li>
<li>How could the results from your predictive model be used in practice?</li>
</ul>
</section>
<section id="causal-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="causal-research-questions">3: Causal Research Questions</h2>
<p>Causal research questions are ultimately what most inferential statistics is interested in, regardless of whether or not we end up being able to make causal conclusions. From the videos for today, you learned about different types of variables, and whether or not they should be included or excluded from a model, depending on your causal research question.</p>
<p>Suppose we are botanists who are interested in studying the causal effect of a pumpkin’s <code>variety</code> on its <code>weight_lbs</code>.</p>
<p>With your groups</p>
<ul>
<li><p>make a causal diagram (DAG) on the whiteboard, including relevant variables that are available in the <code>pumpkins</code> data.</p>
<ul>
<li><p>I recommend talking through each of the variables in the dataset one by one and decide if they should be incorporated into the DAG (draw these as nodes, but don’t draw arrows yet!)</p></li>
<li><p>Consider including all variables you <em>wish</em> you had access to, even if they aren’t available in your data (this is important when thinking about the limitations of your analysis!) (draw these as nodes, but don’t draw arrows yet!)</p></li>
</ul></li>
<li><p>Draw lines/arrows representing what you think are the relationships among these variables</p></li>
<li><p>Label each node with the type of variable it is (predictor of interest, response, confounder, collider, mediator, precision variable, effect modifier)</p></li>
<li><p>Translate your DAG into a linear regression model statement in the form <span class="math inline">\(E[Y | X_1, X_2, ...] = ...\)</span></p></li>
</ul>
</section>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection">Reflection</h2>
<p>This section is all about iterating on a research question, and using those questions to guide the way we explore data and fit statistical models. How confident do you feel in distinguishing between descriptive, predictive, and causal research questions? How confident do you feel in knowing which components of a model matter more or less, in each specific case? What might help you feel more confident?</p>
<blockquote class="blockquote">
<p><strong>Response:</strong> Put your response here.</p>
</blockquote>
</section>
</section>
<section id="part-2" class="level1">
<h1>Part 2</h1>
<p><strong>Context:</strong> Recall that when we talked about model evaluation previously, we asked if the model was correct, strong, and fair (<em>primarily in the context of descriptive/predictive research questions–evaluating the accuracy/strength/fairness of a causal research question can be extremely difficult!</em>)</p>
<p>Today we’ll revisit predictive research questions and some considerations when trying to build <em>strong</em> models. In particular, we’ll consider nuances and limitations to indiscriminately adding more predictors to our model.</p>
<p>First, let’s do a little data cleaning and add a variable <code>ott_cm</code> that is the “over-the-top” measurement of the pumpkin in centimeters (in addition to the <code>ott</code> variable we already have, in inches):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pumpkins <span class="ot">&lt;-</span> pumpkins <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">weight_lbs =</span> <span class="fu">as.numeric</span>(weight_lbs), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">est_weight =</span> <span class="fu">as.numeric</span>(est_weight), </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ott =</span> <span class="fu">as.numeric</span>(ott), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ott_cm =</span> ott <span class="sc">*</span> <span class="fl">2.54</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ott <span class="sc">&gt;</span> <span class="dv">10</span>, ott <span class="sc">&lt;</span> <span class="dv">450</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run the code chunk below to build a bunch of models that you’ll be exploring in the exercises:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pumpkin_model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> ott, pumpkins)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pumpkin_model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> ott_cm, pumpkins)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pumpkin_model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> ott <span class="sc">+</span> ott_cm, pumpkins)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>pumpkin_model_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> est_weight, pumpkins)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>pumpkin_model_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> ott <span class="sc">+</span> est_weight, pumpkins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-1-modeling-weight-by-over-the-top-measurement" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-modeling-weight-by-over-the-top-measurement">Exercise 1: Modeling weight by over-the-top measurement</h2>
<p>What can a pumpkin’s OTT measurement tell us about its weight? To answer this question, we’ll consider 3 of our models:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">predictors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_1</code></td>
<td style="text-align: left;"><code>ott</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pumpkin_model_2</code></td>
<td style="text-align: left;"><code>ott_cm</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_3</code></td>
<td style="text-align: left;"><code>ott + ott_cm</code></td>
</tr>
</tbody>
</table>
<p>Plots of the first two models are below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pumpkins, <span class="fu">aes</span>(<span class="at">y =</span> weight_lbs, <span class="at">x =</span> ott)) <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_L13-mlr-model-building-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="h" width="408"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pumpkins, <span class="fu">aes</span>(<span class="at">y =</span> weight_lbs, <span class="at">x =</span> ott_cm)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_L13-mlr-model-building-1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="h" width="408"></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p><em>Before</em> examining the model summaries, check your intuition. Do you think the <code>pumpkin_model_2</code> R-squared will be less than, equal to, or more than that of <code>pumpkin_model_1</code>? Similarly, how do you think the <code>pumpkin_model_3</code> R-squared will compare to that of <code>pumpkin_model_1</code>?</p></li>
<li><p>Check your intuition: Examine the R-squared values for the three pumpkin models and summarize how these compare.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pumpkin_model_1)<span class="sc">$</span>r.squared</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9081466</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pumpkin_model_2)<span class="sc">$</span>r.squared</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9081466</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pumpkin_model_3)<span class="sc">$</span>r.squared</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9081466</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li>Explain why your observation in part b makes sense. Support your reasoning with a plot of just the 2 <em>predictors</em>: <code>ott</code> vs <code>ott_cm</code>.</li>
</ol>
<ol start="4" type="a">
<li><em>OPTIONAL challenge:</em> In <code>summary(pumpkin_model_3)</code>, the <code>ott_cm</code> coefficient is <code>NA</code>. Explain why this makes sense. HINT: Thinking about what you learned about controlling for covariates, why wouldn’t it make sense to interpret this coefficient? BONUS: For those of you that have taken MATH 236, this has to do with matrices that are not of full rank!</li>
</ol>
</section>
<section id="exercise-2-incorporating-est_weight" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-incorporating-est_weight">Exercise 2: Incorporating <code>est_weight</code></h2>
<p>There are established guidelines for estimating a pumpkin’s weight based on its OTT measurement.</p>
<p>The <a href="https://www.bigpumpkins.com/Attachments/2025%20GPC%20AG%20OTT%20Chart.pdf">most recent guidelines</a> give the following estimation formula:</p>
<p>Weight_lbs =(((12.81/(1+6.87*2<sup>(-OTT_inches/97)))</sup>3+(OTT_inches/45.9)^3.014)-10)</p>
<p>In this exercise you’ll consider 3 models of <code>weight_lbs</code>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">predictors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_1</code></td>
<td style="text-align: left;"><code>ott</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pumpkin_model_4</code></td>
<td style="text-align: left;"><code>est_weight</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_5</code></td>
<td style="text-align: left;"><code>ott + est_weight</code></td>
</tr>
</tbody>
</table>
<ol type="a">
<li><p>Which is the better predictor of <code>weight_lbs</code>: <code>ott</code> or <code>est_weight</code>? Provide some numerical evidence.</p></li>
<li><p><code>pumpkin_model_5</code> incorporates both <code>ott</code> and <code>est_weight</code> as predictors. <em>Before</em> examining a model summary, ask your gut: Will the <code>pumpkin_model_5</code> R-squared be:</p>
<ol type="a">
<li><p>less than 0.91?</p></li>
<li><p>between 0.91 and 0.96?</p></li>
<li><p>a little more than 0.96?</p></li>
<li><p>close to 1?</p></li>
</ol></li>
<li><p>Check your intuition. Report the <code>pumpkin_model_5</code> R-squared and summarize how this compares to that of <code>pumpkin_model_1</code> and <code>pumpkin_model_4</code>.</p></li>
<li><p>Explain why your observation in part c makes sense. Support your reasoning with a plot of the 2 <em>predictors</em>: <code>ott</code> vs <code>est_weight</code>.</p></li>
</ol>
</section>
<section id="exercise-3-redundancy-and-multicollinearity" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-redundancy-and-multicollinearity">Exercise 3: Redundancy and Multicollinearity</h2>
<p>The exercises above have illustrated special phenomena in multivariate modeling:</p>
<ul>
<li>two predictors are <strong>redundant</strong> if they contain the same exact information</li>
<li>two predictors are <strong>multicollinear</strong> if they are strongly associated (they contain very similar information) but are not completely redundant.</li>
</ul>
<p>Recall that we examined 5 models:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">predictors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_1</code></td>
<td style="text-align: left;"><code>ott</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pumpkin_model_2</code></td>
<td style="text-align: left;"><code>ott_cm</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_3</code></td>
<td style="text-align: left;"><code>ott + ott_cm</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pumpkin_model_4</code></td>
<td style="text-align: left;"><code>est_weight</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pumpkin_model_5</code></td>
<td style="text-align: left;"><code>ott + est_weight</code></td>
</tr>
</tbody>
</table>
<ol type="a">
<li>Which model had <em>redundant</em> predictors and which predictors were these?</li>
<li>Which model had <em>multicollinear</em> predictors and which predictors were these?</li>
<li>In general, what happens to the R-squared value if we add a <em>redundant</em> predictor to a model: will it decrease, stay the same, increase by a small amount, or increase by a significant amount?</li>
<li>Similarly, what happens to the R-squared value if we add a <em>multicollinear</em> predictor to a model: will it decrease, stay the same, increase by a small amount, or increase by a significant amount?</li>
</ol>
</section>
<section id="exercise-4-considerations-for-strong-models" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-considerations-for-strong-models">Exercise 4: Considerations for strong models</h2>
<p>Let’s dive deeper into important considerations when building a <em>strong</em> model. We’ll use a subset of the pumpkins data for exploring these ideas.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For illustration purposes only, take a sample of 10 pumpkins.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll discuss this code later in the course!</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">155</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pumpkins_small <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(pumpkins <span class="sc">%&gt;%</span> <span class="fu">filter</span>(weight_lbs <span class="sc">&gt;</span> <span class="dv">400</span>, weight_lbs<span class="sc">&lt;</span><span class="dv">700</span>, ott<span class="sc">&gt;</span><span class="dv">300</span>, <span class="sc">!</span><span class="fu">is.na</span>(weight_lbs), <span class="sc">!</span><span class="fu">is.na</span>(ott)), <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ott =</span> <span class="fu">jitter</span>(ott))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Consider 3 models of bill length:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A model with one predictor (ott)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>poly_mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> ott, pumpkins_small)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A model with two predictors (ott and ott^2)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>poly_mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> <span class="fu">poly</span>(ott, <span class="dv">2</span>), pumpkins_small)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A model with nine predictors (ott, ott^2, ... on up to ott^9)</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>poly_mod_9 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> <span class="fu">poly</span>(ott, <span class="dv">9</span>), pumpkins_small)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li>Before doing any analysis, which of the three models do you think will be best?</li>
<li>Calculate the R-squared values of these 3 models. Which model do you think is best?</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poly_mod_1)<span class="sc">$</span>r.squared</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.0001523791</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poly_mod_2)<span class="sc">$</span>r.squared</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1508085</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poly_mod_9)<span class="sc">$</span>r.squared</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li>Check out plots depicting the relationship estimated by these 3 models. Which model do you think is best?</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A plot of model 1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pumpkins_small, <span class="fu">aes</span>(<span class="at">y =</span> weight_lbs, <span class="at">x =</span> ott)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_L13-mlr-model-building-1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="h" width="408"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A plot of model 2</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pumpkins_small, <span class="fu">aes</span>(<span class="at">y =</span> weight_lbs, <span class="at">x =</span> ott)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_L13-mlr-model-building-1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="h" width="408"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A plot of model 9</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pumpkins_small, <span class="fu">aes</span>(<span class="at">y =</span> weight_lbs, <span class="at">x =</span> ott)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">9</span>), <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_L13-mlr-model-building-1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="h" width="408"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-5-reflecting-on-these-investigations" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5-reflecting-on-these-investigations">Exercise 5: Reflecting on these investigations</h2>
<ol type="a">
<li>List 3 of your favorite foods. Now imagine making a dish that combines all of these foods. Do you think it would taste good?</li>
<li>Too many good things doesn’t make necessarily make a better thing. Model 9 demonstrates that it’s always <em>possible</em> to get a perfect R-squared of 1, but there are drawbacks to putting more and more predictors into our model. Answer the following about model 9:
<ul>
<li>How easy would it be to interpret this model?</li>
<li>Would you say that this model captures the general trend of the relationship between <code>weight_lbs</code> and <code>ott</code>?</li>
<li>How well do you think this model would generalize to pumpkins that were not included in the <code>pumpkins_small</code> sample? For example, would you expect these new pumpkins to fall on the wiggly model 9 curve?</li>
</ul></li>
</ol>
</section>
<section id="exercise-6-overfitting" class="level2">
<h2 class="anchored" data-anchor-id="exercise-6-overfitting">Exercise 6: Overfitting</h2>
<p>Model 9 provides an example of a model that is <strong>overfit</strong> to our sample data. That is, it picks up the tiny details of our data at the cost of losing the more general trends of the relationship of interest. Check out the following <a href="https://xkcd.com/2048/">xkcd comic</a>. Which plot pokes fun at overfitting?</p>
<p><img src="https://imgs.xkcd.com/comics/curve_fitting_2x.png" class="img-fluid"></p>
<p>Some other goodies:</p>
<p><img src="https://pbs.twimg.com/media/EbI7FNxX0AU_gIR.jpg" class="img-fluid"></p>
<p><img src="https://miro.medium.com/max/800/1*cT-z5lx-c0phjaw-iVUxvA.jpeg" class="img-fluid"></p>
</section>
<section id="exercise-7-questioning-r-squared" class="level2">
<h2 class="anchored" data-anchor-id="exercise-7-questioning-r-squared">Exercise 7: Questioning R-squared</h2>
<p>Zooming out, explain some limitations of relying on R-squared to measure the strength / usefulness of a model.</p>
</section>
<section id="exercise-8-adjusted-r-squared" class="level2">
<h2 class="anchored" data-anchor-id="exercise-8-adjusted-r-squared">Exercise 8: Adjusted R-squared</h2>
<p>We’ve seen that, unless a predictor is redundant with another, R-squared will increase. Even if that predictor is strongly multicollinear with another. Even if that predictor isn’t a good predictor! Thus if we only look at R-squared we might get overly greedy. We can check our greedy impulses a few ways. We take a more in depth approach in STAT 253, but one quick alternative is reported right in our model <code>summary()</code> tables. <strong>Adjusted R-squared</strong> includes a <em>penalty</em> for incorporating more and more predictors. Mathematically (where <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(p\)</span> is the number of non-intercept coefficients):</p>
<p><span class="math display">\[
\text{Adjusted } R^2 = 1 - (1 - R^2) \left( \frac{n-1}{n-p-1} \right)
\]</span></p>
<p>Thus unlike R-squared, Adjusted R-squared can <em>decrease</em> when the information that a predictor contributes to a model isn’t enough to offset the complexity it adds to that model. Consider two models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get a subset of pumpkins from a single german competition, for illustrative purposes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pumpkins_de <span class="ot">&lt;-</span> pumpkins <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gpc_site<span class="sc">==</span><span class="st">"XXL-Kuerbis-Wiegemeisterschaft auf dem Krewelshof"</span>, <span class="sc">!</span>(city <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Deurle"</span>, <span class="st">"Lindlar"</span>)), ott <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>example_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> city, pumpkins_de)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>example_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> city <span class="sc">+</span> pct_chart, pumpkins_de)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li>Check out the summaries for the 2 example models. In general, how does a model’s Adjusted R-squared compare to the R-squared? Is it greater, less than, or equal to the R-squared?</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(example_1)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = weight_lbs ~ city, data = pumpkins_de)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    Min     1Q Median     3Q    Max </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -561.5 -111.6    0.0  151.1  416.1 </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)           654.12      52.48  12.464  &lt; 2e-16 ***</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBassum           -504.22     209.93  -2.402 0.018723 *  </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBirlenbach         76.68     153.01   0.501 0.617703    </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBochum           -627.62     209.93  -2.990 0.003748 ** </span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBonn             -325.04      68.72  -4.730 9.96e-06 ***</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="do">## cityDietenhofen       174.28     153.01   1.139 0.258235    </span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="do">## cityGummersbach      -504.77     153.01  -3.299 0.001471 ** </span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="do">## cityKoeln            -119.48      80.69  -1.481 0.142734    </span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="do">## cityLohmar           -350.66      93.04  -3.769 0.000319 ***</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="do">## cityNiederdorfelden  -493.22     209.93  -2.349 0.021366 *  </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="do">## cityOberaden         -422.35     114.38  -3.692 0.000413 ***</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="do">## cityPulheim          -372.04      78.72  -4.726 1.01e-05 ***</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="do">## citySinntal           184.78     209.93   0.880 0.381491    </span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="do">## citySteinheim        -217.58      82.98  -2.622 0.010531 *  </span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="do">## cityWanzele            -9.22     209.93  -0.044 0.965082    </span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="do">## cityZuelpich Enze    -445.77     153.01  -2.913 0.004678 ** </span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 203.3 on 77 degrees of freedom</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   (16 observations deleted due to missingness)</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.4762, Adjusted R-squared:  0.3741 </span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 4.666 on 15 and 77 DF,  p-value: 2.954e-06</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(example_2)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = weight_lbs ~ city + pct_chart, data = pumpkins_de)</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="do">## -528.38  -81.28    0.00   75.91  426.57 </span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)          859.498    106.488   8.071 1.29e-10 ***</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBassum          -198.074    263.149  -0.753 0.455154    </span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBirlenbach         3.488    186.218   0.019 0.985132    </span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBochum          -832.998    236.657  -3.520 0.000931 ***</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="do">## cityBonn            -302.349     94.799  -3.189 0.002462 ** </span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="do">## cityDietenhofen       75.199    185.117   0.406 0.686313    </span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="do">## cityGummersbach     -566.657    214.558  -2.641 0.011000 *  </span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="do">## cityKoeln           -160.395    112.808  -1.422 0.161283    </span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="do">## cityLohmar          -420.608    112.395  -3.742 0.000471 ***</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="do">## cityNiederdorfelden -529.488    245.560  -2.156 0.035900 *  </span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="do">## cityOberaden        -419.972    133.680  -3.142 0.002822 ** </span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="do">## cityPulheim         -379.730    103.895  -3.655 0.000617 ***</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="do">## citySinntal          158.535    264.006   0.600 0.550886    </span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="do">## citySteinheim       -236.284    107.891  -2.190 0.033215 *  </span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="do">## cityWanzele           53.622    250.903   0.214 0.831637    </span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="do">## cityZuelpich Enze   -471.222    195.700  -2.408 0.019776 *  </span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-10.0      -411.649    240.560  -1.711 0.093240 .  </span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-11.0        34.502    236.657   0.146 0.884674    </span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-12.0       -48.186    183.956  -0.262 0.794443    </span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-14.0      -239.403    242.160  -0.989 0.327612    </span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-17.0      -315.503    242.160  -1.303 0.198588    </span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-2.0       -169.110    137.629  -1.229 0.224923    </span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-24.0      -361.868    243.872  -1.484 0.144127    </span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-3.0       -238.518    146.819  -1.625 0.110543    </span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-38.0            NA         NA      NA       NA    </span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-4.0       -268.220    147.573  -1.818 0.075129 .  </span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-5.0        -93.368    126.078  -0.741 0.462425    </span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-6.0       -383.470    155.727  -2.462 0.017289 *  </span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-7.0       -511.524    179.882  -2.844 0.006444 ** </span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-8.0       -268.349    240.560  -1.116 0.269961    </span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart-9.0       -372.359    181.061  -2.057 0.044968 *  </span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart0.0        -179.133    180.854  -0.990 0.326706    </span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart1.0        -243.452    130.859  -1.860 0.068713 .  </span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart11.0       -212.593    157.972  -1.346 0.184451    </span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart13.0        -88.795    210.437  -0.422 0.674868    </span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart15.0       -269.268    243.872  -1.104 0.274819    </span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart2.0        -187.516    146.114  -1.283 0.205284    </span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart22.0        -54.414    240.487  -0.226 0.821916    </span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart3.0        -131.088    120.539  -1.088 0.282024    </span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart4.0        -179.926    138.976  -1.295 0.201388    </span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart6.0        -133.283    167.514  -0.796 0.429994    </span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart7.0        -308.049    240.560  -1.281 0.206260    </span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart8.0        -253.684    141.100  -1.798 0.078232 .  </span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a><span class="do">## pct_chart9.0        -198.186    175.863  -1.127 0.265150    </span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 211.3 on 50 degrees of freedom</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a><span class="do">##   (16 observations deleted due to missingness)</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6323, Adjusted R-squared:  0.3234 </span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 2.047 on 42 and 50 DF,  p-value: 0.007869</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li><p>How did the R-squared change from example model 1 to model 2? How did the Adjusted R-squared change?</p></li>
<li><p>Explain what it is about <code>pct_chart</code> that resulted in a decreased Adjusted R-squared. Note: it’s not necessarily the case that <code>pct_chart</code> is a bad predictor on its own!</p></li>
</ol>
</section>
<section id="reflection-1" class="level2">
<h2 class="anchored" data-anchor-id="reflection-1">Reflection</h2>
<p>Today we looked at some cautions surrounding indiscriminately adding variables to a model. Summarize key takeaways.</p>
<blockquote class="blockquote">
<p><strong>Response:</strong> Put your response here.</p>
</blockquote>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>