<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>l22-hypothesis-testing-discovery – STAT 155</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon-32x32.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 155</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home / Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-activities" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Activities</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-activities">    
        <li>
    <a class="dropdown-item" href="../activities/L25-f-tests.html">
 <span class="dropdown-text">Nested Models &amp; F-Tests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L24-hypothesis-testing-considerations.html">
 <span class="dropdown-text">Hypothesis testing: additional considerations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L23-hypothesis-testing-details.html">
 <span class="dropdown-text">23. Hypothesis testing details and practice</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L22-hypothesis-testing-discovery.html">
 <span class="dropdown-text">Hypothesis testing: discovery</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L21-confidence-intervals.html">
 <span class="dropdown-text">Confidence intervals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L19-20-sampling-dist-clt-bootstrap.html">
 <span class="dropdown-text">Sampling distributions, the CLT, and Bootstrapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L18-sampling-normal.html">
 <span class="dropdown-text">The Normal model &amp; sampling variation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L17-logistic-multiple-evaluation.html">
 <span class="dropdown-text">Multiple logistic regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L16-logistic-univariate.html">
 <span class="dropdown-text">Simple logistic regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L13-mlr-model-building-1.html">
 <span class="dropdown-text">Multiple linear regression: model building (part 1)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L12-mlr-interaction-practice.html">
 <span class="dropdown-text">Multiple linear regression: interaction terms practice</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L10-mlr-confounding.html">
 <span class="dropdown-text">Confounding variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L09-mlr-principles.html">
 <span class="dropdown-text">Multiple regression principles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L08-mlr-intro.html">
 <span class="dropdown-text">Introduction to multiple regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L07-slr-cat-predictor.html">
 <span class="dropdown-text">Simple linear regression: categorical predictor</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L06-slr-transformations.html">
 <span class="dropdown-text">Simple linear regression: Transformations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L05-slr-model-eval.html">
 <span class="dropdown-text">Simple linear regression: model evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L04-slr-formalization.html">
 <span class="dropdown-text">Simple linear regression: formalizing concepts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L03-slr-introduction.html">
 <span class="dropdown-text">Simple linear regression: Visualization and Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L02-foundations-univariate.html">
 <span class="dropdown-text">Univariate visualization and summaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../activities/L01-foundations-welcome.html">
 <span class="dropdown-text">Data Collection Activity and Intro to R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../assignments.html"> 
<span class="menu-text">Practice Problems</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project.html"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tech_setup.html"> 
<span class="menu-text">Tech Setup</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../activities/L22-hypothesis-testing-discovery.html">Hypothesis testing: discovery</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
 <span class="menu-text">activities/L26-p-values-discussion.qmd</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L25-f-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nested Models &amp; F-Tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L24-hypothesis-testing-considerations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypothesis testing: additional considerations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L23-hypothesis-testing-details.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">23. Hypothesis testing details and practice</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L22-hypothesis-testing-discovery.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Hypothesis testing: discovery</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L21-confidence-intervals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confidence intervals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L19-20-sampling-dist-clt-bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling distributions, the CLT, and Bootstrapping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L18-sampling-normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Normal model &amp; sampling variation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L17-logistic-multiple-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple logistic regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L16-logistic-univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple logistic regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L13-mlr-model-building-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple linear regression: model building (part 1)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L12-mlr-interaction-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple linear regression: interaction terms practice</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L10-mlr-confounding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confounding variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L09-mlr-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple regression principles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L08-mlr-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to multiple regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L07-slr-cat-predictor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression: categorical predictor</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L06-slr-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression: Transformations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L05-slr-model-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression: model evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L04-slr-formalization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression: formalizing concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L03-slr-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple linear regression: Visualization and Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L02-foundations-univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Univariate visualization and summaries</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../activities/L01-foundations-welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Collection Activity and Intro to R</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#hypothesis-testing-discovery" id="toc-hypothesis-testing-discovery" class="nav-link active" data-scroll-target="#hypothesis-testing-discovery">Hypothesis testing: discovery</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a>
  <ul class="collapse">
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li><a href="#readings-and-videos" id="toc-readings-and-videos" class="nav-link" data-scroll-target="#readings-and-videos">Readings and videos</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-1-review" id="toc-exercise-1-review" class="nav-link" data-scroll-target="#exercise-1-review">Exercise 1: Review</a>
  <ul class="collapse">
  <li><a href="#part-a" id="toc-part-a" class="nav-link" data-scroll-target="#part-a">Part a</a></li>
  <li><a href="#part-b" id="toc-part-b" class="nav-link" data-scroll-target="#part-b">Part b</a></li>
  <li><a href="#part-c" id="toc-part-c" class="nav-link" data-scroll-target="#part-c">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-2-test-a-hypothesis-using-the-ci" id="toc-exercise-2-test-a-hypothesis-using-the-ci" class="nav-link" data-scroll-target="#exercise-2-test-a-hypothesis-using-the-ci">Exercise 2: Test a hypothesis using the CI</a>
  <ul class="collapse">
  <li><a href="#part-a-1" id="toc-part-a-1" class="nav-link" data-scroll-target="#part-a-1">Part a</a></li>
  <li><a href="#part-b-1" id="toc-part-b-1" class="nav-link" data-scroll-target="#part-b-1">Part b</a></li>
  </ul></li>
  <li><a href="#exercise-3-simulating-data-under-the-null-value" id="toc-exercise-3-simulating-data-under-the-null-value" class="nav-link" data-scroll-target="#exercise-3-simulating-data-under-the-null-value">Exercise 3: Simulating data under the null value</a>
  <ul class="collapse">
  <li><a href="#part-a-2" id="toc-part-a-2" class="nav-link" data-scroll-target="#part-a-2">Part a</a></li>
  <li><a href="#part-b-2" id="toc-part-b-2" class="nav-link" data-scroll-target="#part-b-2">Part b</a></li>
  <li><a href="#part-c-1" id="toc-part-c-1" class="nav-link" data-scroll-target="#part-c-1">Part c</a></li>
  <li><a href="#part-d" id="toc-part-d" class="nav-link" data-scroll-target="#part-d">Part d</a></li>
  </ul></li>
  <li><a href="#exercise-4-comparing-our-sample-results-to-the-null-value-intuition" id="toc-exercise-4-comparing-our-sample-results-to-the-null-value-intuition" class="nav-link" data-scroll-target="#exercise-4-comparing-our-sample-results-to-the-null-value-intuition">Exercise 4: Comparing our sample results to the null value (intuition)</a>
  <ul class="collapse">
  <li><a href="#part-a-3" id="toc-part-a-3" class="nav-link" data-scroll-target="#part-a-3">Part a</a></li>
  <li><a href="#part-b-3" id="toc-part-b-3" class="nav-link" data-scroll-target="#part-b-3">Part b</a></li>
  <li><a href="#part-c-2" id="toc-part-c-2" class="nav-link" data-scroll-target="#part-c-2">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-5-clt" id="toc-exercise-5-clt" class="nav-link" data-scroll-target="#exercise-5-clt">Exercise 5: CLT</a></li>
  <li><a href="#exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic" id="toc-exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic" class="nav-link" data-scroll-target="#exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic">Exercise 6: Comparing our sample results to the null value (test statistic)</a>
  <ul class="collapse">
  <li><a href="#part-a-4" id="toc-part-a-4" class="nav-link" data-scroll-target="#part-a-4">Part a</a></li>
  <li><a href="#part-b-4" id="toc-part-b-4" class="nav-link" data-scroll-target="#part-b-4">Part b</a></li>
  <li><a href="#part-c-3" id="toc-part-c-3" class="nav-link" data-scroll-target="#part-c-3">Part c</a></li>
  <li><a href="#part-d-1" id="toc-part-d-1" class="nav-link" data-scroll-target="#part-d-1">Part d</a></li>
  </ul></li>
  <li><a href="#exercise-7-comparing-our-sample-results-to-the-null-value-p-value" id="toc-exercise-7-comparing-our-sample-results-to-the-null-value-p-value" class="nav-link" data-scroll-target="#exercise-7-comparing-our-sample-results-to-the-null-value-p-value">Exercise 7: Comparing our sample results to the null value (p-value)</a>
  <ul class="collapse">
  <li><a href="#part-a-5" id="toc-part-a-5" class="nav-link" data-scroll-target="#part-a-5">Part a</a></li>
  <li><a href="#part-b-5" id="toc-part-b-5" class="nav-link" data-scroll-target="#part-b-5">Part b</a></li>
  <li><a href="#part-c-4" id="toc-part-c-4" class="nav-link" data-scroll-target="#part-c-4">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-8-river-test-part-i" id="toc-exercise-8-river-test-part-i" class="nav-link" data-scroll-target="#exercise-8-river-test-part-i">Exercise 8: River test Part I</a>
  <ul class="collapse">
  <li><a href="#part-a-6" id="toc-part-a-6" class="nav-link" data-scroll-target="#part-a-6">Part a</a></li>
  <li><a href="#part-b-6" id="toc-part-b-6" class="nav-link" data-scroll-target="#part-b-6">Part b</a></li>
  <li><a href="#part-c-5" id="toc-part-c-5" class="nav-link" data-scroll-target="#part-c-5">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-9-river-test-part-ii" id="toc-exercise-9-river-test-part-ii" class="nav-link" data-scroll-target="#exercise-9-river-test-part-ii">Exercise 9: River test Part II</a>
  <ul class="collapse">
  <li><a href="#part-a-7" id="toc-part-a-7" class="nav-link" data-scroll-target="#part-a-7">Part a</a></li>
  <li><a href="#part-b-7" id="toc-part-b-7" class="nav-link" data-scroll-target="#part-b-7">Part b</a></li>
  <li><a href="#part-c-6" id="toc-part-c-6" class="nav-link" data-scroll-target="#part-c-6">Part c</a></li>
  <li><a href="#part-d-2" id="toc-part-d-2" class="nav-link" data-scroll-target="#part-d-2">Part d</a></li>
  <li><a href="#part-e" id="toc-part-e" class="nav-link" data-scroll-target="#part-e">Part e</a></li>
  </ul></li>
  <li><a href="#exercise-10-river-ci" id="toc-exercise-10-river-ci" class="nav-link" data-scroll-target="#exercise-10-river-ci">Exercise 10: River CI</a>
  <ul class="collapse">
  <li><a href="#part-a-8" id="toc-part-a-8" class="nav-link" data-scroll-target="#part-a-8">Part a</a></li>
  <li><a href="#part-b-8" id="toc-part-b-8" class="nav-link" data-scroll-target="#part-b-8">Part b</a></li>
  <li><a href="#part-c-7" id="toc-part-c-7" class="nav-link" data-scroll-target="#part-c-7">Part c</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#solutions" id="toc-solutions" class="nav-link" data-scroll-target="#solutions">Solutions</a>
  <ul class="collapse">
  <li><a href="#exercise-1-review-1" id="toc-exercise-1-review-1" class="nav-link" data-scroll-target="#exercise-1-review-1">Exercise 1: Review</a>
  <ul class="collapse">
  <li><a href="#part-a-9" id="toc-part-a-9" class="nav-link" data-scroll-target="#part-a-9">Part a</a></li>
  <li><a href="#part-b-9" id="toc-part-b-9" class="nav-link" data-scroll-target="#part-b-9">Part b</a></li>
  <li><a href="#part-c-8" id="toc-part-c-8" class="nav-link" data-scroll-target="#part-c-8">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-2-test-a-hypothesis-using-the-ci-1" id="toc-exercise-2-test-a-hypothesis-using-the-ci-1" class="nav-link" data-scroll-target="#exercise-2-test-a-hypothesis-using-the-ci-1">Exercise 2: Test a hypothesis using the CI</a>
  <ul class="collapse">
  <li><a href="#part-a-10" id="toc-part-a-10" class="nav-link" data-scroll-target="#part-a-10">Part a</a></li>
  <li><a href="#part-b-10" id="toc-part-b-10" class="nav-link" data-scroll-target="#part-b-10">Part b</a></li>
  </ul></li>
  <li><a href="#exercise-3-simulating-data-under-the-null-value-1" id="toc-exercise-3-simulating-data-under-the-null-value-1" class="nav-link" data-scroll-target="#exercise-3-simulating-data-under-the-null-value-1">Exercise 3: Simulating data under the null value</a>
  <ul class="collapse">
  <li><a href="#part-a-11" id="toc-part-a-11" class="nav-link" data-scroll-target="#part-a-11">Part a</a></li>
  <li><a href="#part-b-11" id="toc-part-b-11" class="nav-link" data-scroll-target="#part-b-11">Part b</a></li>
  <li><a href="#part-c-9" id="toc-part-c-9" class="nav-link" data-scroll-target="#part-c-9">Part c</a></li>
  <li><a href="#part-d-3" id="toc-part-d-3" class="nav-link" data-scroll-target="#part-d-3">Part d</a></li>
  </ul></li>
  <li><a href="#exercise-4-comparing-our-sample-results-to-the-null-value-intuition-1" id="toc-exercise-4-comparing-our-sample-results-to-the-null-value-intuition-1" class="nav-link" data-scroll-target="#exercise-4-comparing-our-sample-results-to-the-null-value-intuition-1">Exercise 4: Comparing our sample results to the null value (intuition)</a>
  <ul class="collapse">
  <li><a href="#part-a-12" id="toc-part-a-12" class="nav-link" data-scroll-target="#part-a-12">Part a</a></li>
  <li><a href="#part-b-12" id="toc-part-b-12" class="nav-link" data-scroll-target="#part-b-12">Part b</a></li>
  <li><a href="#part-c-10" id="toc-part-c-10" class="nav-link" data-scroll-target="#part-c-10">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-5-clt-1" id="toc-exercise-5-clt-1" class="nav-link" data-scroll-target="#exercise-5-clt-1">Exercise 5: CLT</a></li>
  <li><a href="#exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic-1" id="toc-exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic-1" class="nav-link" data-scroll-target="#exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic-1">Exercise 6: Comparing our sample results to the null value (test statistic)</a>
  <ul class="collapse">
  <li><a href="#part-a-13" id="toc-part-a-13" class="nav-link" data-scroll-target="#part-a-13">Part a</a></li>
  <li><a href="#part-b-13" id="toc-part-b-13" class="nav-link" data-scroll-target="#part-b-13">Part b</a></li>
  <li><a href="#part-c-11" id="toc-part-c-11" class="nav-link" data-scroll-target="#part-c-11">Part c</a></li>
  <li><a href="#part-d-4" id="toc-part-d-4" class="nav-link" data-scroll-target="#part-d-4">Part d</a></li>
  </ul></li>
  <li><a href="#exercise-7-comparing-our-sample-results-to-the-null-value-p-value-1" id="toc-exercise-7-comparing-our-sample-results-to-the-null-value-p-value-1" class="nav-link" data-scroll-target="#exercise-7-comparing-our-sample-results-to-the-null-value-p-value-1">Exercise 7: Comparing our sample results to the null value (p-value)</a>
  <ul class="collapse">
  <li><a href="#part-a-14" id="toc-part-a-14" class="nav-link" data-scroll-target="#part-a-14">Part a</a></li>
  <li><a href="#part-b-14" id="toc-part-b-14" class="nav-link" data-scroll-target="#part-b-14">Part b</a></li>
  <li><a href="#part-c-12" id="toc-part-c-12" class="nav-link" data-scroll-target="#part-c-12">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-8-river-test-part-i-1" id="toc-exercise-8-river-test-part-i-1" class="nav-link" data-scroll-target="#exercise-8-river-test-part-i-1">Exercise 8: River test Part I</a>
  <ul class="collapse">
  <li><a href="#part-a-15" id="toc-part-a-15" class="nav-link" data-scroll-target="#part-a-15">Part a</a></li>
  <li><a href="#part-b-15" id="toc-part-b-15" class="nav-link" data-scroll-target="#part-b-15">Part b</a></li>
  <li><a href="#part-c-13" id="toc-part-c-13" class="nav-link" data-scroll-target="#part-c-13">Part c</a></li>
  </ul></li>
  <li><a href="#exercise-9-river-test-part-ii-1" id="toc-exercise-9-river-test-part-ii-1" class="nav-link" data-scroll-target="#exercise-9-river-test-part-ii-1">Exercise 9: River test Part II</a>
  <ul class="collapse">
  <li><a href="#part-a-16" id="toc-part-a-16" class="nav-link" data-scroll-target="#part-a-16">Part a</a></li>
  <li><a href="#part-b-16" id="toc-part-b-16" class="nav-link" data-scroll-target="#part-b-16">Part b</a></li>
  <li><a href="#part-c-14" id="toc-part-c-14" class="nav-link" data-scroll-target="#part-c-14">Part c</a></li>
  <li><a href="#part-d-5" id="toc-part-d-5" class="nav-link" data-scroll-target="#part-d-5">Part d</a></li>
  <li><a href="#part-e-1" id="toc-part-e-1" class="nav-link" data-scroll-target="#part-e-1">Part e</a></li>
  </ul></li>
  <li><a href="#exercise-10-river-ci-1" id="toc-exercise-10-river-ci-1" class="nav-link" data-scroll-target="#exercise-10-river-ci-1">Exercise 10: River CI</a>
  <ul class="collapse">
  <li><a href="#part-a-17" id="toc-part-a-17" class="nav-link" data-scroll-target="#part-a-17">Part a</a></li>
  <li><a href="#part-b-17" id="toc-part-b-17" class="nav-link" data-scroll-target="#part-b-17">Part b</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="hypothesis-testing-discovery" class="level1">
<h1>Hypothesis testing: discovery</h1>
<!-- create student notes from activity in core-->
<!-- pull activity from core -->
</section>
<section id="notes" class="level1">
<h1>Notes</h1>
<ul>
<li>You can download a template file to work with <a href="../template_qmds/22_hypothesis_testing_discovery-notes.qmd">here</a>.</li>
<li><strong>File organization:</strong> Save this file in the “Activities” subfolder of your “STAT155” folder.</li>
</ul>
<section id="learning-goals" class="level2">
<h2 class="anchored" data-anchor-id="learning-goals">Learning goals</h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Understand how standard errors and confidence intervals enable us to make statistical inferences</li>
<li>Articulate how we can formalize a research question as a testable, statistical hypothesis</li>
</ul>
</section>
<section id="readings-and-videos" class="level2">
<h2 class="anchored" data-anchor-id="readings-and-videos">Readings and videos</h2>
<p>This is a discovery activity, so no assigned readings/videos today.</p>
</section>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<p>Let’s return to the <code>fish</code> dataset. Recall that rivers contain small concentrations of mercury which can accumulate in fish. Scientists studied this phenomenon among 171 largemouth bass in the Wacamaw and Lumber rivers of North Carolina, recording the following:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: left;">meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">River</td>
<td style="text-align: left;">Lumber or Wacamaw</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station</td>
<td style="text-align: left;">Station number where the fish was caught (0, 1, …, 15)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Length</td>
<td style="text-align: left;">Fish’s length (in centimeters)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Weight</td>
<td style="text-align: left;">Fish’s weight (in grams)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Concen</td>
<td style="text-align: left;">Fish’s mercury concentration (in parts per million; ppm)</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data &amp; packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://mac-stat.github.io/data/Mercury.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-1-review" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-review">Exercise 1: Review</h2>
<p><strong>Research goal:</strong> Explore the relationship of mercury concentration (<code>Concen</code>) with the size of a fish, as measured by its <code>Length</code>. To this end, we’ll use our <em>sample data</em> to make <em>inferences</em> about the broader <em>population model</em>:</p>
<p><span class="math display">\[
E[Concen | Length] = \beta_0 + \beta_1 Length
\]</span></p>
<section id="part-a" class="level3">
<h3 class="anchored" data-anchor-id="part-a">Part a</h3>
<p>Fit a simple linear regression model that would address our research question.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fish_mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Concen <span class="sc">~</span> Length, <span class="at">data =</span> fish)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fish_mod_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interpret <span class="math inline">\(\hat{\beta}_1\)</span>, our sample <em>estimate</em> of the “true” <span class="math inline">\(\beta_1\)</span> <code>Length</code> coefficient.</p>
</section>
<section id="part-b" class="level3">
<h3 class="anchored" data-anchor-id="part-b">Part b</h3>
<p>Using the 68-95-99.7 rule, construct an <em>approximate</em> 95% confidence interval for <span class="math inline">\(\beta_1\)</span>. That is, calculate an <em>interval estimate</em> of <span class="math inline">\(\beta_1\)</span>. Compare your CI to an <em>exact</em> 95% CI:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fish_mod_1, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c" class="level3">
<h3 class="anchored" data-anchor-id="part-c">Part c</h3>
<p>Interpret the 95% CI in context.</p>
</section>
</section>
<section id="exercise-2-test-a-hypothesis-using-the-ci" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-test-a-hypothesis-using-the-ci">Exercise 2: Test a hypothesis using the CI</h2>
<p>Is there enough evidence here to support the <strong>hypothesis</strong> that among the broader fish <em>population</em> of fish, not just our sample, that mercury levels are associated with / differ by fish length? That is, is there enough evidence to conclude that the slope of the <em>population</em> model is non-0:</p>
<p><span class="math display">\[\beta_1 \ne 0\]</span></p>
<p>NOTE: We’ll refer to 0 as the <strong>null value</strong> to which we’re comparing <span class="math inline">\(\beta_1\)</span>.</p>
<section id="part-a-1" class="level3">
<h3 class="anchored" data-anchor-id="part-a-1">Part a</h3>
<p>Explain why we <em>can’t</em> use our simple estimate <span class="math inline">\(\hat{\beta}_1\)</span> to evaluate this hypothesis, but we <em>can</em> use the 95% CI for <span class="math inline">\(\beta_1\)</span>. (This is true in general, not just this fish example!)</p>
</section>
<section id="part-b-1" class="level3">
<h3 class="anchored" data-anchor-id="part-b-1">Part b</h3>
<p>So, does your 95% CI from Exercise 1 support the hypothesis that there’s a relationship between mercury levels and fish length? Explain.</p>
</section>
</section>
<section id="exercise-3-simulating-data-under-the-null-value" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-simulating-data-under-the-null-value">Exercise 3: Simulating data under the null value</h2>
<p>Though CIs can help us evaluate hypotheses, <strong>hypothesis tests</strong> provide a more formal approach. The general idea:</p>
<ul>
<li><p>Assume that the hypothesis is <em>not</em> true. That is, assume that there’s <em>no</em> association between mercury concentration and fish length (<span class="math inline">\(\beta_1 = 0\)</span>).</p></li>
<li><p>Then, evaluate how compatible your observed sample data are with this assumption that <span class="math inline">\(\beta_1 = 0\)</span>.</p></li>
</ul>
<p>Let’s focus on the first step here. Specifically, let’s explore how our sample data might behave if in fact there were <em>no</em> association between mercury concentration and fish length.</p>
<section id="part-a-2" class="level3">
<h3 class="anchored" data-anchor-id="part-a-2">Part a</h3>
<p>Read carefully:</p>
<ul>
<li>Suppose that when each individual fish in our sample was collected, the scientists wrote its <code>Concen</code> and <code>Length</code> on a piece of paper.</li>
<li>They then ripped the paper in half, with the observed <code>Concen</code> on one half and the observed <code>Length</code> on the other.</li>
<li>They then accidentally dropped the pieces of paper! In the resulting mess, they couldn’t tell which <code>Length</code> observation went with each <code>Concen</code> observation.</li>
<li>To cover up their mistake, they just randomly matched up the <code>Length</code> and <code>Concen</code> pieces of paper. Essentially, in this shuffling process, the scientists broke the bond of the original <code>Length</code> and <code>Concen</code> pairs.</li>
</ul>
<p>Question: Intuitively, if the researchers plotted the new pairs of <code>Concen</code> and <code>Length</code> values, what do you think their scatterplot would look like? What about the sample model?</p>
</section>
<section id="part-b-2" class="level3">
<h3 class="anchored" data-anchor-id="part-b-2">Part b</h3>
<p>We can simulate this idea in RStudio! Throughout, focus on concepts over code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First check out the first 6 fish</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, randomly shuffle the <code>Length</code> values! That is, break the original <code>Concen</code> and <code>Length</code> pairs, and just randomly assign <code>Length</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this chunk a few times!!</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the Length values</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Length =</span> <span class="fu">sample</span>(Length, <span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check out the sample models that arise from the shuffled <code>Concen</code> and <code>Length</code> pairs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the Length values</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this chunk a few times!!</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Then plot the resulting sample data and model</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Length =</span> <span class="fu">sample</span>(Length, <span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> Concen)) <span class="sc">+</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Question: Summarize your observations! Was your intuition in Part a correct?</p>
</section>
<section id="part-c-1" class="level3">
<h3 class="anchored" data-anchor-id="part-c-1">Part c</h3>
<p>These shuffled samples give us a sense of the sample models we’d expect IF <span class="math inline">\(\beta_1\)</span> were actually 0, i.e.&nbsp;if there were no relationship between <code>Concen</code> and <code>Length</code> in the broader population of fish. To get a sense of the range of possible outcomes in this scenario, let’s simulate a bunch of shuffled samples. Specifically, take 500 different shuffled samples and use each to estimate the model of <code>Concen</code> by <code>Length</code> (gray lines). Summarize your observations!! If there were truly no relationship between <code>Concen</code> and <code>Length</code>, how would we expect the sample data to behave?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">do</span>(<span class="dv">500</span>)<span class="sc">*</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  fish <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Length =</span> <span class="fu">sample</span>(Length, <span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(Concen <span class="sc">~</span> Length))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shuffled_models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> Concen)) <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> shuffled_models, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> Intercept, <span class="at">slope =</span> Length), </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="co"># Ignore this line. It's a clunky workaround</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-d" class="level3">
<h3 class="anchored" data-anchor-id="part-d">Part d</h3>
<p>Finally, focus on just the <em>slope</em> estimates <span class="math inline">\(\hat{\beta}_1\)</span> behind the lines above. If there were truly no relationship between <code>Concen</code> and <code>Length</code>, i.e.&nbsp;<span class="math inline">\(\beta_1\)</span> were truly 0, how would we expect the sample slopes to behave?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercise-4-comparing-our-sample-results-to-the-null-value-intuition" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-comparing-our-sample-results-to-the-null-value-intuition">Exercise 4: Comparing our sample results to the null value (intuition)</h2>
<p>Now that we’ve simulated how sample data might behave if there were truly no relationship between <code>Concen</code> and <code>Length</code> (i.e.&nbsp;if <span class="math inline">\(\beta_1\)</span> were 0), let’s consider the next important step in a <strong>hypothesis test</strong>:</p>
<p>Evaluate how compatible our observed sample data are with this assumption that <span class="math inline">\(\beta_1 = 0\)</span>!</p>
<section id="part-a-3" class="level3">
<h3 class="anchored" data-anchor-id="part-a-3">Part a</h3>
<p>Let’s start with a visual assessment. Is <em>our</em> sample model (blue line) consistent / compatible with the “null models” simulated under the assumption the <span class="math inline">\(\beta_1 = 0\)</span> (gray lines)?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> Concen)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> shuffled_models, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> Intercept, <span class="at">slope =</span> Length), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-b-3" class="level3">
<h3 class="anchored" data-anchor-id="part-b-3">Part b</h3>
<p>Consider another visual assessment, focusing just on the <em>slopes</em> of the lines in the plot above, i.e.&nbsp;our sample estimates <span class="math inline">\(\hat{\beta}_1\)</span>. Is <em>our</em> sample slope of <span class="math inline">\(\hat{\beta}_1 = 0.05813\)</span> (blue line) consistent / compatible with the collection of slopes from the “null models” (density plot)?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05813</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-2" class="level3">
<h3 class="anchored" data-anchor-id="part-c-2">Part c</h3>
<p>In Part b, you evaluated the compatibility of <em>our</em> sample slope <span class="math inline">\(\hat{\beta}_1 = 0.05813\)</span> model with slopes of the “null models” using visual cues alone. But for a formal hypothesis test, we need some <em>numerical</em> measures of compatibility. Brainstorm some ideas!</p>
</section>
</section>
<section id="exercise-5-clt" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5-clt">Exercise 5: CLT</h2>
<p>Now that we’ve built up some intuition using simulation, let’s formalize these concepts. You shouldn’t be surprised to know that sampling distributions are at the heart of hypothesis testing! The distribution of slopes from our shuffled sample models uses <em>simulation</em> to <em>approximate</em> the sampling distribution of slope estimates <span class="math inline">\(\hat{\beta}_1\)</span> we’d expect if the population slope <span class="math inline">\(\beta_1\)</span> were actually 0 (the null value):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also approximate the sampling distribution using mathematical <em>theory</em>, specifically the Central Limit Theorem. If <span class="math inline">\(\beta_1\)</span> were truly 0, then the distribution of possible sample estimates <span class="math inline">\(\hat{\beta}_1\)</span> would be Normally distributed around 0:</p>
<p><span class="math display">\[
\hat{\beta}_1 \sim N(0, s.e.(\hat{\beta}_1)^2)
\]</span></p>
<p>where in Exercise 1 we approximated the standard error to be 0.005. Thus a plot of the CLT is below. Confirm that this is <em>similar</em> to the simulated sampling distribution above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't worry about this code!!!</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save your plot</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span><span class="fl">0.005</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">sd =</span> <span class="fl">0.005</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.005</span>)) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> y), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span><span class="fl">0.005</span>) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>clt_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic" class="level2">
<h2 class="anchored" data-anchor-id="exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic">Exercise 6: Comparing our sample results to the null value (test statistic)</h2>
<p><em>Our</em> sample slope estimate of <span class="math inline">\(\hat{\beta}_1 = 0.05813\)</span> is shown on the sampling distribution of sample slopes <span class="math inline">\(\hat{\beta}_1\)</span> that we’d expect if the population slope <span class="math inline">\(\beta_1\)</span> were actually 0 (the null value):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05813</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To measure how compatible (or incompatible) our estimate is with the null value, we can measure the <em>distance</em> between the two.</p>
<section id="part-a-4" class="level3">
<h3 class="anchored" data-anchor-id="part-a-4">Part a</h3>
<p>Quick questions:</p>
<ul>
<li><p>How far is <em>our</em> sample slope estimate of <span class="math inline">\(\hat{\beta}_1 = 0.05813\)</span> from the null value of 0?</p></li>
<li><p>In the context of this particular analysis, is that a big or a small number? How can you tell?</p></li>
</ul>
</section>
<section id="part-b-4" class="level3">
<h3 class="anchored" data-anchor-id="part-b-4">Part b</h3>
<p>In practice, we <em>standardize</em> our distance calculations so that they have the same meaning no matter the context of the analysis. We can do this by calculating a z-score:</p>
<p><span class="math display">\[
\frac{\hat{\beta}_1 - \text{null value}}{s.e.(\hat{\beta}_1))} = \text{ number of s.e. that $\hat{\beta}_1$ falls from the null value}
\]</span></p>
<p>This is called the <strong>test statistic</strong>. Calculate <em>and interpret</em> the test statistic for our example.</p>
</section>
<section id="part-c-3" class="level3">
<h3 class="anchored" data-anchor-id="part-c-3">Part c</h3>
<p>Within rounding, the same test statistic appears in our model summary table! Where is it?!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-d-1" class="level3">
<h3 class="anchored" data-anchor-id="part-d-1">Part d</h3>
<p>What can we conclude from your test statistic calculation and interpretation:</p>
<ul>
<li><p>Our sample data is <em>not</em> consistent with the null value of <span class="math inline">\(\beta_1 = 0\)</span>, i.e.&nbsp;the idea that there’s no significant association between mercury concentration and length.</p></li>
<li><p>Our sample data <em>is</em> consistent with the null value of <span class="math inline">\(\beta_1 = 0\)</span>.</p></li>
</ul>
</section>
</section>
<section id="exercise-7-comparing-our-sample-results-to-the-null-value-p-value" class="level2">
<h2 class="anchored" data-anchor-id="exercise-7-comparing-our-sample-results-to-the-null-value-p-value">Exercise 7: Comparing our sample results to the null value (p-value)</h2>
<p>Again, <em>our</em> sample slope estimate of <span class="math inline">\(\hat{\beta}_1 = 0.05813\)</span> is shown on the sampling distribution of sample slopes <span class="math inline">\(\hat{\beta}_1\)</span> that we’d expect if the population slope <span class="math inline">\(\beta_1\)</span> were actually 0 (the null value):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05813</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="part-a-5" class="level3">
<h3 class="anchored" data-anchor-id="part-a-5">Part a</h3>
<p>Another way to evaluate the compatibility of our estimate with the null value of <span class="math inline">\(\beta_1 = 0\)</span> is to ask how likely we are to have gotten this estimate if the null value were indeed true! That is, what’s the <em>probability</em> that we would have gotten a sample slope that’s at least 0.058 above <em>or</em> below 0 IF in fact there were <em>no</em> association between mercury concentration and length? Use the 68-95-99.7 Rule with the plot above to approximate the p-value:</p>
<ul>
<li>less than 0.003</li>
<li>between 0.003 and 0.05</li>
<li>between 0.05 and 0.32</li>
<li>bigger than 0.32</li>
</ul>
</section>
<section id="part-b-5" class="level3">
<h3 class="anchored" data-anchor-id="part-b-5">Part b</h3>
<p>The calculation above is called a <strong>p-value</strong>. A more accurate p-value is reported in the model summary table in the <code>Pr(&gt;|t|)</code> column. What is it?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-4" class="level3">
<h3 class="anchored" data-anchor-id="part-c-4">Part c</h3>
<p>How can we interpret the p-value?</p>
<ul>
<li><p>It’s very unlikely that we’d have observed such a steep increase in <code>Concen</code> with <code>Length</code> among our sample fish “by chance”, i.e.&nbsp;if in fact there were no relationship between mercury concentration and length in the broader fish population.</p></li>
<li><p>In light of our sample data, it’s very unlikely that mercury concentration is associated with length.</p></li>
<li><p>In light of our sample data, it’s very unlikely that mercury concentration and length are unrelated.</p></li>
</ul>
</section>
</section>
<section id="exercise-8-river-test-part-i" class="level2">
<h2 class="anchored" data-anchor-id="exercise-8-river-test-part-i">Exercise 8: River test Part I</h2>
<p>The fish in our sample come from two different rivers: Lumber and Wacamaw. <strong>Research question:</strong> Is there evidence that the mercury concentration in fish differs between the 2 rivers? To answer this question, we’ll control for fish <code>Length</code> – we don’t want to mistakenly detect a difference in mercury levels just because we happened to sample bigger fish in one river and smaller fish in the other. The relevant population model is:</p>
<p><span class="math display">\[
E[Concen | River, Length] = \beta_0 + \beta_1 RiverWacamaw + \beta_2 Length
\]</span></p>
<section id="part-a-6" class="level3">
<h3 class="anchored" data-anchor-id="part-a-6">Part a</h3>
<p>To address the above research question, which model coefficient / population parameter is of primary interest: <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, or <span class="math inline">\(\beta_2\)</span>?</p>
<p>And what’s the <em>null value</em> of this coefficient? That is, what would this coefficient be if there were truly no difference in mercury concentration between the 2 rivers (when controlling for length)?</p>
</section>
<section id="part-b-6" class="level3">
<h3 class="anchored" data-anchor-id="part-b-6">Part b</h3>
<p>For the parameter of interest, obtain and report a sample estimate and its corresponding standard error:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fish_mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(___, <span class="at">data =</span> fish)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-5" class="level3">
<h3 class="anchored" data-anchor-id="part-c-5">Part c</h3>
<p>Let’s use this data to evaluate our research question. To do so, remember the next step: Assume that the null value from Part a is correct and determine what sample estimates we would <em>expect</em> to get in this scenario.</p>
<p>Adjust the code below to sketch the appropriate sampling distribution. Represent <em>our</em> sample estimate by a blue line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put OUR sample estimate here</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Round to 3 digits</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> ___</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the corresponding standard error here</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round to 3 digits</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> ___</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span>se) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">sd =</span> se)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> se)) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> y), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span>se) <span class="sc">+</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> est, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercise-9-river-test-part-ii" class="level2">
<h2 class="anchored" data-anchor-id="exercise-9-river-test-part-ii">Exercise 9: River test Part II</h2>
<p>Remember the next step: We must evaluate how compatible our sample estimate is with the null value. We’ll take 3 approaches: using a visual assessment, test statistic, and p-value.</p>
<section id="part-a-7" class="level3">
<h3 class="anchored" data-anchor-id="part-a-7">Part a</h3>
<p>Visually, in Part c of the previous exercise, does our sample estimate seem compatible with the null value? Mainly, is our estimate consistent with what we’d expect to observe if there were truly no difference in the mercury concentration between the 2 rivers (when controlling for fish length)?</p>
</section>
<section id="part-b-7" class="level3">
<h3 class="anchored" data-anchor-id="part-b-7">Part b</h3>
<p>Calculate <em>and interpret</em> the test statistic. Do this calculation by hand and check your work in the model summary table.</p>
</section>
<section id="part-c-6" class="level3">
<h3 class="anchored" data-anchor-id="part-c-6">Part c</h3>
<p>Recall that the p-value calculates the <em>probability</em> that, IF in fact the null value were correct (i.e.&nbsp;there was actually <em>no</em> difference in mercury concentration by river when controlling for length), we would have gotten a sample estimate that’s as far from the null value as ours, either above or below. Use the 68-95-99.7 Rule with the plot in Part c of the previous exercise to approximate the p-value:</p>
<ul>
<li>less than 0.003</li>
<li>between 0.003 and 0.05</li>
<li>between 0.05 and 0.32</li>
<li>bigger than 0.32</li>
</ul>
<p>Now obtain and report the exact p-value from the model summary table.</p>
</section>
<section id="part-d-2" class="level3">
<h3 class="anchored" data-anchor-id="part-d-2">Part d</h3>
<p>Do your test statistic and p-value indicate that your estimate is or is not compatible with the null value? Explain.</p>
</section>
<section id="part-e" class="level3">
<h3 class="anchored" data-anchor-id="part-e">Part e</h3>
<p>Putting this all together, what do you conclude? When controlling for length…</p>
<ul>
<li>we have evidence of a statistically significant difference in mercury concentration by river.</li>
<li>we do not have sufficient evidence to conclude that there’s a statistically significant difference in mercury concentration by river.</li>
</ul>
</section>
</section>
<section id="exercise-10-river-ci" class="level2">
<h2 class="anchored" data-anchor-id="exercise-10-river-ci">Exercise 10: River CI</h2>
<section id="part-a-8" class="level3">
<h3 class="anchored" data-anchor-id="part-a-8">Part a</h3>
<p>Finally, construct a 95% CI for the population parameter of interest in our river analysis.</p>
</section>
<section id="part-b-8" class="level3">
<h3 class="anchored" data-anchor-id="part-b-8">Part b</h3>
<p>What do you conclude from this CI? When controlling for length…</p>
<ul>
<li>we have evidence of a statistically significant difference in mercury concentration by river.</li>
<li>we do not have sufficient evidence to conclude that there’s a statistically significant difference in mercury concentration by river.</li>
</ul>
</section>
<section id="part-c-7" class="level3">
<h3 class="anchored" data-anchor-id="part-c-7">Part c</h3>
<p>Your conclusions from the hypothesis test (test statistic and p-value) should agree with those from your CI! If this is not the case, review your work.</p>
<p><br>
<br>
<br>
<br>
</p>
</section>
</section>
</section>
<section id="solutions" class="level1">
<h1>Solutions</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data &amp; packages</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://mac-stat.github.io/data/Mercury.csv"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fish)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 5</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   River  Station Length Weight Concen</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Lumber       0   47     1616   1.6 </span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Lumber       0   48.7   1862   1.5 </span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Lumber       0   55.7   2855   1.7 </span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Lumber       0   45.2   1199   0.73</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 Lumber       0   44.7   1320   0.56</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 Lumber       0   43.8   1225   0.51</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-1-review-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-review-1">Exercise 1: Review</h2>
<section id="part-a-9" class="level3">
<h3 class="anchored" data-anchor-id="part-a-9">Part a</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fish_mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Concen <span class="sc">~</span> Length, <span class="at">data =</span> fish)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fish_mod_1)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = Concen ~ Length, data = fish)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -1.1499 -0.3436 -0.1022  0.3123  1.9100 </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="do">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -1.131645   0.213615  -5.298 3.62e-07 ***</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Length       0.058127   0.005228  11.119  &lt; 2e-16 ***</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 0.5805 on 169 degrees of freedom</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.4225, Adjusted R-squared:  0.4191 </span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 123.6 on 1 and 169 DF,  p-value: &lt; 2.2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We estimate that for every 1cm increase in length, the expected mercury concentration increases by 0.058ppm.</p>
</section>
<section id="part-b-9" class="level3">
<h3 class="anchored" data-anchor-id="part-b-9">Part b</h3>
<p><span class="math inline">\(0.058 \pm 2*0.005 = (0.058 - 0.010, 0.058 + 0.010) = (0.048, 0.068)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fish_mod_1, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                   2.5 %      97.5 %</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -1.55334248 -0.70994835</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Length       0.04780769  0.06844728</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-8" class="level3">
<h3 class="anchored" data-anchor-id="part-c-8">Part c</h3>
<p>We’re 95% confident that for every 1cm increase in length, the expected mercury concentration increases by somewhere between 0.048ppm and 0.068ppm.</p>
</section>
</section>
<section id="exercise-2-test-a-hypothesis-using-the-ci-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-test-a-hypothesis-using-the-ci-1">Exercise 2: Test a hypothesis using the CI</h2>
<section id="part-a-10" class="level3">
<h3 class="anchored" data-anchor-id="part-a-10">Part a</h3>
<p>The simple estimate <span class="math inline">\(\hat{\beta}_1\)</span> has error that we need to account for when making inferences about the population. The CI accounts for this error!</p>
</section>
<section id="part-b-10" class="level3">
<h3 class="anchored" data-anchor-id="part-b-10">Part b</h3>
<p>Yes, the interval doesn’t include 0. Thus 0 is not a plausible value for <span class="math inline">\(\beta_1\)</span>.</p>
</section>
</section>
<section id="exercise-3-simulating-data-under-the-null-value-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-simulating-data-under-the-null-value-1">Exercise 3: Simulating data under the null value</h2>
<section id="part-a-11" class="level3">
<h3 class="anchored" data-anchor-id="part-a-11">Part a</h3>
<p>Intuition.</p>
</section>
<section id="part-b-11" class="level3">
<h3 class="anchored" data-anchor-id="part-b-11">Part b</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First check out the first 6 fish</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 2</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Concen Length</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   1.6    47  </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2   1.5    48.7</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   1.7    55.7</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   0.73   45.2</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 5   0.56   44.7</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 6   0.51   43.8</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this chunk a few times!!</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the Length values</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Length =</span> <span class="fu">sample</span>(Length, <span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 2</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="do">##   Concen Length</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   1.6    34.5</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 2   1.5    43.2</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   1.7    40.5</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   0.73   46.5</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 5   0.56   32  </span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 6   0.51   35</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the Length values</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this chunk a few times!!</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Then plot the resulting sample data and model</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Length =</span> <span class="fu">sample</span>(Length, <span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> Concen)) <span class="sc">+</span> </span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-c-9" class="level3">
<h3 class="anchored" data-anchor-id="part-c-9">Part c</h3>
<p>If there were truly no relationship between <code>Concen</code> and <code>Length</code>, we’d expect the sample model to have a slope near to (but not exactly) 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">do</span>(<span class="dv">500</span>)<span class="sc">*</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  fish <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Concen, Length) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Length =</span> <span class="fu">sample</span>(Length, <span class="at">size =</span> <span class="fu">length</span>(Length), <span class="at">replace =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">lm</span>(Concen <span class="sc">~</span> Length))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shuffled_models)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   Intercept        Length     sigma    r.squared           F numdf dendf .row</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 0.7994259  0.0075368727 0.6765800 7.371664e-03 1.255063194     1   169    1</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 0.9584317  0.0037391031 0.7811844 2.031882e-03 0.344087261     1   169    1</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 0.8270447  0.0089664603 0.7691294 9.240981e-03 1.576292349     1   169    1</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 0.7629911  0.0118477349 0.8498595 1.539909e-02 2.643148655     1   169    1</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 1.0765620 -0.0004547678 0.6746811 2.931604e-05 0.004954555     1   169    1</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 0.5069886  0.0188557911 0.8317681 3.879420e-02 6.820829143     1   169    1</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   .index</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 1      1</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2      2</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      3</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 4      4</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 5      5</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 6      6</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> Concen)) <span class="sc">+</span> </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> shuffled_models, </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> Intercept, <span class="at">slope =</span> Length), </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="co"># Ignore this line. It's a clunky workaround</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-d-3" class="level3">
<h3 class="anchored" data-anchor-id="part-d-3">Part d</h3>
<p>We’d expect slopes to be Normally distributed around 0 (the null value).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-4-comparing-our-sample-results-to-the-null-value-intuition-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-comparing-our-sample-results-to-the-null-value-intuition-1">Exercise 4: Comparing our sample results to the null value (intuition)</h2>
<section id="part-a-12" class="level3">
<h3 class="anchored" data-anchor-id="part-a-12">Part a</h3>
<p>No! Its slope is much bigger than for the sample models simulated using the null value!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length, <span class="at">y =</span> Concen)) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> shuffled_models, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> Intercept, <span class="at">slope =</span> Length), </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-b-12" class="level3">
<h3 class="anchored" data-anchor-id="part-b-12">Part b</h3>
<p>No! Our slope is much bigger than for the sample models simulated using the null value!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05813</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-c-10" class="level3">
<h3 class="anchored" data-anchor-id="part-c-10">Part c</h3>
<p>Will vary.</p>
</section>
</section>
<section id="exercise-5-clt-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5-clt-1">Exercise 5: CLT</h2>
<p>The simulated and CLT / theory-informed sampling distributions are similar!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>shuffled_models <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span><span class="fl">0.005</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">sd =</span> <span class="fl">0.005</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.005</span>)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> y), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span><span class="fl">0.005</span>) <span class="sc">+</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>clt_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-6-comparing-our-sample-results-to-the-null-value-test-statistic-1">Exercise 6: Comparing our sample results to the null value (test statistic)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05813</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="part-a-13" class="level3">
<h3 class="anchored" data-anchor-id="part-a-13">Part a</h3>
<ul>
<li><p>How far is <em>our</em> sample slope estimate of <span class="math inline">\(\hat{\beta}_1 = 0.05813\)</span> from the null value of 0? 0.05813 :)</p></li>
<li><p>In the context of this particular analysis, is that a big or a small number? How can you tell? This seems pretty big relative to the standard error.</p></li>
</ul>
</section>
<section id="part-b-13" class="level3">
<h3 class="anchored" data-anchor-id="part-b-13">Part b</h3>
<p>Our sample slope of 0.058 falls more than 11 standard errors above the null value of 0. That’s far!!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.058127</span> <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fl">0.005228</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-11" class="level3">
<h3 class="anchored" data-anchor-id="part-c-11">Part c</h3>
<p>In the <code>t value</code> column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-d-4" class="level3">
<h3 class="anchored" data-anchor-id="part-d-4">Part d</h3>
<ul>
<li>Our sample data is <em>not</em> consistent with the null value of <span class="math inline">\(\beta_1 = 0\)</span>, i.e.&nbsp;the idea that there’s no significant association between mercury concentration and length.</li>
</ul>
</section>
</section>
<section id="exercise-7-comparing-our-sample-results-to-the-null-value-p-value-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-7-comparing-our-sample-results-to-the-null-value-p-value-1">Exercise 7: Comparing our sample results to the null value (p-value)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05813</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="part-a-14" class="level3">
<h3 class="anchored" data-anchor-id="part-a-14">Part a</h3>
<p>Our estimate is more than 3 s.e. away from 0. Since 99.7% of estimates fall within 3 s.e. the probability of this happening is…</p>
<ul>
<li>less than 0.003 (1 - 0.997)</li>
</ul>
</section>
<section id="part-b-14" class="level3">
<h3 class="anchored" data-anchor-id="part-b-14">Part b</h3>
<p>&lt; 2e-16 (which is very very close to 0)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_1))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                Estimate  Std. Error   t value     Pr(&gt;|t|)</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -1.13164542 0.213614796 -5.297598 3.617750e-07</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Length       0.05812749 0.005227593 11.119359 6.641225e-22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-12" class="level3">
<h3 class="anchored" data-anchor-id="part-c-12">Part c</h3>
<ul>
<li>It’s very unlikely that we’d have observed such a steep increase in <code>Concen</code> with <code>Length</code> among our sample fish “by chance”, i.e.&nbsp;if in fact there were no relationship between mercury concentration and length in the broader fish population.</li>
</ul>
</section>
</section>
<section id="exercise-8-river-test-part-i-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-8-river-test-part-i-1">Exercise 8: River test Part I</h2>
<section id="part-a-15" class="level3">
<h3 class="anchored" data-anchor-id="part-a-15">Part a</h3>
<p><span class="math inline">\(\beta_1\)</span>, the RiverWacamaw coefficient</p>
<p>The null value is <span class="math inline">\(\beta_1 = 0\)</span></p>
</section>
<section id="part-b-15" class="level3">
<h3 class="anchored" data-anchor-id="part-b-15">Part b</h3>
<p><span class="math inline">\(\hat{\beta}_1 = 0.142\)</span> with a standard error of 0.089:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fish_mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Concen <span class="sc">~</span> River <span class="sc">+</span> Length, <span class="at">data =</span> fish)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_2))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate  Std. Error   t value     Pr(&gt;|t|)</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  -1.19422929 0.216287220 -5.521497 1.255595e-07</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="do">## RiverWacamaw  0.14202739 0.089496454  1.586961 1.144018e-01</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Length        0.05765684 0.005212709 11.060821 1.033822e-21</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-13" class="level3">
<h3 class="anchored" data-anchor-id="part-c-13">Part c</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put OUR sample estimate here</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Round to 3 digits</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fl">0.142</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the corresponding standard error here</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round to 3 digits</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fl">0.089</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span>se) <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x, <span class="at">sd =</span> se)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> se)) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> y), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">*</span>se) <span class="sc">+</span> </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> est, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="L22-hypothesis-testing-discovery_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="do">## $x</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] ""</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,"class")</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "labels"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercise-9-river-test-part-ii-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-9-river-test-part-ii-1">Exercise 9: River test Part II</h2>
<section id="part-a-16" class="level3">
<h3 class="anchored" data-anchor-id="part-a-16">Part a</h3>
<p>Yes! Our estimate is relatively close to 0 on this scale (within 2 s.e.).</p>
</section>
<section id="part-b-16" class="level3">
<h3 class="anchored" data-anchor-id="part-b-16">Part b</h3>
<p>Our estimate of <span class="math inline">\(\beta_1\)</span>, 0.142, falls only 1.59 s.e. from 0:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.142</span> <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fl">0.089</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.595506</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_2))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate  Std. Error   t value     Pr(&gt;|t|)</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  -1.19422929 0.216287220 -5.521497 1.255595e-07</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="do">## RiverWacamaw  0.14202739 0.089496454  1.586961 1.144018e-01</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Length        0.05765684 0.005212709 11.060821 1.033822e-21</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-c-14" class="level3">
<h3 class="anchored" data-anchor-id="part-c-14">Part c</h3>
<p>Our estimate is somewhere between 1 and 2 s.e. from 0:</p>
<ul>
<li>between 0.05 and 0.32</li>
</ul>
<p>An exact p-value is 0.114:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fish_mod_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-d-5" class="level3">
<h3 class="anchored" data-anchor-id="part-d-5">Part d</h3>
<p>It is. It is not very far from 0 (when considering s.e.) and would not be unlikely to observe if the null value were true.</p>
</section>
<section id="part-e-1" class="level3">
<h3 class="anchored" data-anchor-id="part-e-1">Part e</h3>
<p>When controlling for length…</p>
<ul>
<li>we do not have sufficient evidence to conclude that there’s a statistically significant difference in mercury concentration by river.</li>
</ul>
</section>
</section>
<section id="exercise-10-river-ci-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-10-river-ci-1">Exercise 10: River CI</h2>
<section id="part-a-17" class="level3">
<h3 class="anchored" data-anchor-id="part-a-17">Part a</h3>
<p>Rough version:</p>
<p><span class="math inline">\(0.142 \pm 2*0.089 = (-0.036, 0.320)\)</span></p>
<p>Exact version:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fish_mod_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="part-b-17" class="level3">
<h3 class="anchored" data-anchor-id="part-b-17">Part b</h3>
<p>When controlling for length…</p>
<ul>
<li>we do not have sufficient evidence to conclude that there’s a statistically significant difference in mercury concentration by river.</li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Jedidiah Carlson, 2025<br> All content licensed under <img src="https://static.thenounproject.com/png/70967-200.png" height="20"> (<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>)</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Site built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>